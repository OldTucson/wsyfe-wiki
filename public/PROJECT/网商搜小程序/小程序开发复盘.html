<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å°ç¨‹åºå¼€å‘å¤ç›˜ | WSY-FE-WIKI</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.380c562e.css" as="style"><link rel="preload" href="/assets/js/app.f7a45569.js" as="script"><link rel="preload" href="/assets/js/3.2c4a51d3.js" as="script"><link rel="preload" href="/assets/js/18.f868f70d.js" as="script"><link rel="prefetch" href="/assets/js/1.ea282701.js"><link rel="prefetch" href="/assets/js/10.df4ac057.js"><link rel="prefetch" href="/assets/js/11.f435db7c.js"><link rel="prefetch" href="/assets/js/12.1a387f53.js"><link rel="prefetch" href="/assets/js/13.c12efee5.js"><link rel="prefetch" href="/assets/js/14.088d3929.js"><link rel="prefetch" href="/assets/js/15.bc9949db.js"><link rel="prefetch" href="/assets/js/16.8a0e587b.js"><link rel="prefetch" href="/assets/js/17.0ad8b2d3.js"><link rel="prefetch" href="/assets/js/19.768237d3.js"><link rel="prefetch" href="/assets/js/20.43485b7d.js"><link rel="prefetch" href="/assets/js/21.64b13b1f.js"><link rel="prefetch" href="/assets/js/22.428c09a7.js"><link rel="prefetch" href="/assets/js/23.3953fbcb.js"><link rel="prefetch" href="/assets/js/24.63480178.js"><link rel="prefetch" href="/assets/js/25.20c97721.js"><link rel="prefetch" href="/assets/js/26.28df8cde.js"><link rel="prefetch" href="/assets/js/27.3426aa39.js"><link rel="prefetch" href="/assets/js/28.91f4c80d.js"><link rel="prefetch" href="/assets/js/29.d699e82d.js"><link rel="prefetch" href="/assets/js/30.30abc996.js"><link rel="prefetch" href="/assets/js/31.e9429980.js"><link rel="prefetch" href="/assets/js/32.acb3c9db.js"><link rel="prefetch" href="/assets/js/33.75b09251.js"><link rel="prefetch" href="/assets/js/34.9f2b063e.js"><link rel="prefetch" href="/assets/js/35.309b3741.js"><link rel="prefetch" href="/assets/js/36.bfd93081.js"><link rel="prefetch" href="/assets/js/37.6b37a491.js"><link rel="prefetch" href="/assets/js/38.15953f9c.js"><link rel="prefetch" href="/assets/js/39.49277fbd.js"><link rel="prefetch" href="/assets/js/4.3243bfa8.js"><link rel="prefetch" href="/assets/js/40.c1f38e45.js"><link rel="prefetch" href="/assets/js/41.12e0c433.js"><link rel="prefetch" href="/assets/js/42.abd03687.js"><link rel="prefetch" href="/assets/js/43.55c4ed1a.js"><link rel="prefetch" href="/assets/js/44.cf7adb79.js"><link rel="prefetch" href="/assets/js/45.7e793487.js"><link rel="prefetch" href="/assets/js/46.823cf365.js"><link rel="prefetch" href="/assets/js/47.c8edae13.js"><link rel="prefetch" href="/assets/js/48.fdd5155c.js"><link rel="prefetch" href="/assets/js/49.8b20bcdc.js"><link rel="prefetch" href="/assets/js/5.8b508fa4.js"><link rel="prefetch" href="/assets/js/6.51cbce5a.js"><link rel="prefetch" href="/assets/js/7.56c916fe.js"><link rel="prefetch" href="/assets/js/8.1d5bfc5a.js"><link rel="prefetch" href="/assets/js/9.cf7e0a2a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.380c562e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">WSY-FE-WIKI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/TOOLS/CSS/æ»šåŠ¨æ¡æ ·å¼.html" class="nav-link">
  å·¥å…·
</a></div><div class="nav-item"><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html" class="nav-link">
  é¡¹ç›®
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/TOOLS/CSS/æ»šåŠ¨æ¡æ ·å¼.html" class="nav-link">
  å·¥å…·
</a></div><div class="nav-item"><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html" class="nav-link">
  é¡¹ç›®
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ğŸŒµç½‘å•†æœå°ç¨‹åº</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html" class="active sidebar-link">å°ç¨‹åºå¼€å‘å¤ç›˜</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html#ğŸ“-éœ€æ±‚åœºæ™¯" class="sidebar-link">ğŸ“ éœ€æ±‚åœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html#â­-æ”¶è·çš„æŠ€å·§" class="sidebar-link">â­ æ”¶è·çš„æŠ€å·§</a></li><li class="sidebar-sub-header"><a href="/PROJECT/ç½‘å•†æœå°ç¨‹åº/å°ç¨‹åºå¼€å‘å¤ç›˜.html#ğŸ’¡-é‡åˆ°çš„é—®é¢˜" class="sidebar-link">ğŸ’¡ é‡åˆ°çš„é—®é¢˜</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ğŸ“-éœ€æ±‚åœºæ™¯"><a href="#ğŸ“-éœ€æ±‚åœºæ™¯" class="header-anchor">#</a> ğŸ“ éœ€æ±‚åœºæ™¯</h2> <p>ç½‘å•†æœå°ç¨‹åºç‰ˆåº”ç”¨å¼€å‘ï¼Œæ¶‰åŠåŠŸèƒ½æœ‰è´¦æˆ·ä½“ç³»ã€ç”¨æˆ·ä¸‹å•æµç¨‹ã€è®¢å•å”®åæµç¨‹ç­‰</p> <h2 id="â­-æ”¶è·çš„æŠ€å·§"><a href="#â­-æ”¶è·çš„æŠ€å·§" class="header-anchor">#</a> â­ æ”¶è·çš„æŠ€å·§</h2> <h3 id="_1-å¾®ä¿¡ç™»å½•æµç¨‹"><a href="#_1-å¾®ä¿¡ç™»å½•æµç¨‹" class="header-anchor">#</a> 1.å¾®ä¿¡ç™»å½•æµç¨‹</h3> <blockquote><p>ğŸ“ æµç¨‹å›¾</p></blockquote> <p><img src="/login-er.jpg" alt="æµç¨‹å›¾"></p> <p>ğŸ”§ å…·ä½“å®ç°</p> <blockquote><p>åŸºæœ¬æ ·å¼</p></blockquote> <p><img src="/login-style.jpg" alt="åŸºæœ¬æ ·å¼"></p> <blockquote><p>ä¸ºæŒ‰é’®ç»‘å®šå¯¹åº”çš„ open-type å’Œ bindgetuserinfo å±æ€§å³å¯ç¼ºçœå¼åœ°ï¼ˆæœ‰æˆæƒåˆ™ä¸å”¤èµ·ï¼‰å”¤èµ·å¾®ä¿¡è·å–ä¿¡æ¯æˆæƒå¼¹æ¡†</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getUserInfo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindgetuserinfo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindGetUserInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>å¾®ä¿¡ç”¨æˆ·å¿«æ·ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

//å¦‚æœæ˜¯æ‰‹æœºå·ç™»å½•åˆ™éœ€è¦å…ˆç»‘å®šæ‰‹æœºå·
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getPhoneNumber<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindgetphonenumber</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getPhoneNumber<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  ç»‘å®šæ‰‹æœº
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç‚¹å‡»æˆæƒ</span>
  <span class="token function">bindGetUserInfo</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> userInfo <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>userInfo<span class="token punctuation">;</span>
    <span class="token comment">// ç‚¹å‡»åŒæ„æˆæƒ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;userInfo&quot;</span><span class="token punctuation">,</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
      wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token operator">...</span><span class="token comment">//ç™»å½•é€»è¾‘</span>
          <span class="token comment">//å¦‚æœæ˜¯æ‰‹æœºå·ç™»å½•åˆ™éœ€è¯·æ±‚æœåŠ¡ç«¯åˆ¤æ–­æ˜¯å¦å·²ç»‘å®šæ‰‹æœº</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
               <span class="token comment">//æ‰‹æœºå·æˆæƒ</span>
  <span class="token function">getPhoneNumber</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>encryptedData <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>
      avatarUrl<span class="token punctuation">,</span>
      nickName
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>userInfo
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>
          code
        <span class="token punctuation">}</span> <span class="token operator">=</span> res

        <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
          code<span class="token punctuation">,</span>
          encryptedData<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>encryptedData<span class="token punctuation">,</span>
          iv<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>iv<span class="token punctuation">,</span>
          nick<span class="token operator">:</span> nickName<span class="token punctuation">,</span>
          cover<span class="token operator">:</span> avatarUrl
        <span class="token punctuation">}</span>
        <span class="token comment">//ä»æˆæƒä¿¡æ¯ä¸­è·å–æ•°æ®å‘é€ç»™æœåŠ¡ç«¯è¿›è¡Œç»‘å®šæˆ–æ³¨å†Œæ“ä½œ</span>
        <span class="token constant">XXXXX</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token operator">...</span>
          <span class="token comment">//æˆåŠŸåå°†æœåŠ¡ç«¯è¿”å›çš„tokenåšæœ¬åœ°å­˜å‚¨</span>
          <span class="token keyword">let</span> access_token <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>access_token
          wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span> access_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><p>å°è£…ç™»å½•æ‹¦æˆªå‡½æ•°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">isLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">shouldJump <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> token <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldJump<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&quot;/pages/login/login&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-å¾®ä¿¡æ”¯ä»˜æµç¨‹"><a href="#_2-å¾®ä¿¡æ”¯ä»˜æµç¨‹" class="header-anchor">#</a> 2.å¾®ä¿¡æ”¯ä»˜æµç¨‹</h3> <p>ğŸ”§ å…·ä½“å®ç°</p> <blockquote><p>æ ¹æ®ä¸šåŠ¡åœºæ™¯éœ€è¦ï¼Œé¡¹ç›®ä¸­çš„æ”¯ä»˜å¯è¿›è¡Œè´¦æˆ·ä½™é¢+åŠ å¾®ä¿¡æ”¯ä»˜çš„æ··åˆæ”¯ä»˜æ–¹å¼ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ï¼Œåªå¯¹å¾®ä¿¡æ”¯ä»˜éƒ¨åˆ†è¿›è¡Œåˆ†æ</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">WeiXinPay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å¾®ä¿¡æ”¯ä»˜é€»è¾‘/å¾®ä¿¡é¢å¤–æ”¯ä»˜</span>
    <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>

          <span class="token keyword">let</span> <span class="token punctuation">{</span>
            order_id<span class="token punctuation">,</span>
          <span class="token punctuation">}</span> <span class="token operator">=</span> that<span class="token punctuation">.</span>data
          <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
            order_id<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>order_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
          <span class="token comment">//å‘æœåŠ¡ç«¯å‘é€è®¢å•IDæ¢å–ç”¨äºå¾®ä¿¡æ”¯ä»˜çš„ä¿¡æ¯</span>
          <span class="token function">reqGetWeixinPayInfo</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">let</span> <span class="token punctuation">{</span>
                nonceStr<span class="token punctuation">,</span>
                signType<span class="token punctuation">,</span>
                timeStamp<span class="token punctuation">,</span>
                sign<span class="token punctuation">,</span>
                trade_sn
              <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
              <span class="token keyword">let</span> package1 <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>package <span class="token comment">//ç›´æ¥ç”¨packageè§£æ„ä¼šæŠ¥å…³é”®å­—çš„é”™è¯¯ æ•…è¿™é‡Œä½¿ç”¨è¿™ç§æ†¨æ†¨å†™æ³•</span>
              wx<span class="token punctuation">.</span><span class="token function">requestPayment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token comment">// æ—¶é—´æˆ³</span>
                timeStamp<span class="token punctuation">,</span>
                <span class="token comment">// éšæœºå­—ç¬¦ä¸²</span>
                nonceStr<span class="token punctuation">,</span>
                <span class="token comment">// ç»Ÿä¸€ä¸‹å•æ¥å£è¿”å›çš„ prepay_id å‚æ•°å€¼</span>
                <span class="token keyword">package</span><span class="token operator">:</span> package1<span class="token punctuation">,</span>
                <span class="token comment">// ç­¾åç±»å‹</span>
                signType<span class="token punctuation">,</span>
                <span class="token comment">// ç­¾å</span>
                paySign<span class="token operator">:</span> sign<span class="token punctuation">,</span>
                <span class="token comment">// è°ƒç”¨æˆåŠŸå›è°ƒ</span>
                <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token comment">//æ”¯ä»˜æˆåŠŸåçš„é€»è¾‘</span>
                  <span class="token comment">//å¾®ä¿¡APIæä¾›çš„æ”¯ä»˜æˆåŠŸå›è°ƒå¹¶ä¸èƒ½ä½œä¸ºçœŸæ­£æ”¯ä»˜æˆåŠŸçš„åˆ¤æ–­</span>
                  <span class="token comment">//æ­£ç¡®çš„åšæ³•æ˜¯åœ¨å›è°ƒä¸­å‘æœåŠ¡ç«¯è¯·æ±‚æ”¯ä»˜çŠ¶æ€</span>
                  that<span class="token punctuation">.</span><span class="token function">getPayStatus</span><span class="token punctuation">(</span><span class="token punctuation">{</span>trade_sn<span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// å¤±è´¥å›è°ƒ</span>
                <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  that<span class="token punctuation">.</span><span class="token function">getPayStatus</span><span class="token punctuation">(</span><span class="token punctuation">{</span>trade_sn<span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// æ¥å£è°ƒç”¨ç»“æŸå›è°ƒ</span>
                <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                title<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
                icon<span class="token operator">:</span> <span class="token string">'none'</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_3-å°ç¨‹åºå†…çš„æ»‘åŠ¨åˆ é™¤åŠŸèƒ½"><a href="#_3-å°ç¨‹åºå†…çš„æ»‘åŠ¨åˆ é™¤åŠŸèƒ½" class="header-anchor">#</a> 3.å°ç¨‹åºå†…çš„æ»‘åŠ¨åˆ é™¤åŠŸèƒ½</h3> <p>ğŸ”§ å…·ä½“å®ç°</p> <blockquote><p>æ ¹æ®å®é™…åº”ç”¨åœºæ™¯å°è£…ç”¨äºæ»‘åŠ¨æ‹–æ‹½çš„ç±»</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TouchesNormal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">_getIndex</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æ»‘åŠ¨åˆ—è¡¨çš„ä¸‹æ ‡å€¼</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_getMoveX</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> startX</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æ»‘åŠ¨è¿‡ç¨‹ä¸­æ»‘åŠ¨çš„è·ç¦»</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClientX</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">-</span> startX<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_getEndX</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> startX</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æ»‘åŠ¨ç»“æŸæ»‘åŠ¨çš„è·ç¦»</span>
    <span class="token keyword">let</span> touch <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>touch<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> touch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX <span class="token operator">-</span> startX<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">_resetData</span><span class="token punctuation">(</span><span class="token parameter">dataList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// é‡ç½®æ•°æ®ï¼Œ æŠŠæ‰€æœ‰çš„åˆ—è¡¨ left ç½®ä¸º 0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> dataList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dataList<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getClientX</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æ»‘åŠ¨çš„æ¨ªåæ ‡</span>
    <span class="token keyword">let</span> touch <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>touch<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> touch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">touchM</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> dataList<span class="token punctuation">,</span> startX</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// touchmove è¿‡ç¨‹ä¸­æ›´æ–°åˆ—è¡¨æ•°æ®</span>
    <span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_resetData</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> goodsindex <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">;</span>
    list<span class="token punctuation">[</span>goodsindex<span class="token punctuation">]</span><span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getMoveX</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> startX<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">touchE</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> dataList<span class="token punctuation">,</span> startX<span class="token punctuation">,</span> width</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// touchend æ›´æ–°åˆ—è¡¨æ•°æ®</span>
    <span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_resetData</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> disX <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getEndX</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> startX<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>disX <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åˆ¤æ–­æ»‘åŠ¨æ–¹å‘ï¼Œ ï¼ˆå‘å·¦æ»‘åŠ¨ï¼‰</span>
      <span class="token comment">// æ»‘åŠ¨çš„è·ç¦»å¤§äºåˆ é™¤å®½åº¦çš„ä¸€åŠå°±æ˜¾ç¤ºæ“ä½œåˆ—è¡¨ å¦åˆ™ä¸æ˜¾ç¤º</span>
      Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>disX<span class="token punctuation">)</span> <span class="token operator">&gt;</span> width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token punctuation">(</span>left <span class="token operator">=</span> <span class="token operator">-</span>width<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// å‘å³æ»‘åŠ¨å¤ä½</span>
      left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> goodsindex <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">;</span>
    list<span class="token punctuation">[</span>goodsindex<span class="token punctuation">]</span><span class="token punctuation">.</span>left <span class="token operator">=</span> left<span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> dataList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ é™¤åŠŸèƒ½</span>
    dataList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getIndex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dataList<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> TouchesNormal<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>å°†å…¶æŒ‚è½½æŒ‚è½½è‡³ app.js ä¸­</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//app.js</span>
<span class="token operator">...</span>
<span class="token keyword">import</span> TouchesNormal <span class="token keyword">from</span> <span class="token string">'./utils/TouchesNormal.js'</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token operator">...</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  TouchesNormal<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">TouchesNormal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>åœ¨é¡µé¢ä¸­å¼•ç”¨</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  <span class="token comment">/**
   * é¡µé¢çš„åˆå§‹æ•°æ®
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    cardList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//é“¶è¡Œå¡åˆ—è¡¨</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">//è§£ç»‘</span>
  <span class="token function">unbindAccount</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token comment">//ç›¸å…³æ“ä½œé€»è¾‘</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">touchS</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// touchstart</span>
    <span class="token keyword">let</span> startX <span class="token operator">=</span> app<span class="token punctuation">.</span>TouchesNormal<span class="token punctuation">.</span><span class="token function">getClientX</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    startX <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      startX
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">touchM</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// touchmove</span>
    <span class="token operator">...</span>
    <span class="token keyword">let</span> cardList <span class="token operator">=</span> app<span class="token punctuation">.</span>TouchesNormal<span class="token punctuation">.</span><span class="token function">touchM</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>cardList<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>startX<span class="token punctuation">)</span>
      cardList <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        cardList
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">touchE</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// touchend</span>
    <span class="token operator">...</span>
    <span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">80</span> <span class="token comment">// å®šä¹‰æ“ä½œåˆ—è¡¨å®½åº¦ æ­¤å¤„å®½åº¦è¦ä¸é¡µé¢ä¸­æ»‘åŠ¨æ“ä½œé¡¹å®½åº¦ä¸€è‡´</span>
    <span class="token keyword">let</span> cardList <span class="token operator">=</span> app<span class="token punctuation">.</span>TouchesNormal<span class="token punctuation">.</span><span class="token function">touchE</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>cardList<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>startX<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    cardList <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cardList
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>é¡µé¢å¸ƒå±€ï¼š</p> <p>æœ€å¤–å±‚çˆ¶çº§å®¹å™¨ä½¿ç”¨ position:relative</p> <p>å±•ç¤ºå®¹å™¨å’Œæ“ä½œé¡¹å®¹å™¨éƒ½æ˜¯ç”¨ç»å¯¹å®šä½ position:absolute å¹¶ä¸”å®½åº¦éƒ½ä¸çˆ¶å®¹å™¨ä¸€è‡´</p> <p>æœ€åå°†å±•ç¤ºå®¹å™¨çš„ z-index è®¾ç½®å¾—æ¯”æ“ä½œé¡¹å®¹å™¨çš„æ›´å¤§å³å¯</p> <blockquote><p>åŠ¨æ€åœ°ä¸ºå±•ç¤ºå®¹å™¨ä¿®æ”¹ç»å¯¹å®šä½çš„ left å±æ€§å³å¯å®ç°æœ€ç»ˆæ•ˆæœ</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
  <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{cardList}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cardItem<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">wx:</span>for-index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cardIndex<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{cardIndex}}<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-item {{<span class="token punctuation">'</span>list-item<span class="token punctuation">'</span> + cardIndex%3}}<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">data-goodsindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{cardIndex}}<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">bindtouchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>touchS<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">bindtouchmove</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>touchM<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">bindtouchend</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>touchE<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name">
    <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token selector">left:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>cardItem.left + <span class="token string">'rpx'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    ...//å±•ç¤ºå®¹å™¨
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>option-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    ...//æ“ä½œé¡¹
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>unbindAccount<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{cardItem.id}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>åˆ é™¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_4-å°ç¨‹åºå†…è§£æ-html"><a href="#_4-å°ç¨‹åºå†…è§£æ-html" class="header-anchor">#</a> 4.å°ç¨‹åºå†…è§£æ HTML</h3> <p>ğŸ“ å°ç¨‹åºé¡¹ç›®ä¸­æ¶‰åŠåˆ°ç”¨æˆ·åè®®ç­‰ä¸šåŠ¡é€šå¸¸æ˜¯ä½¿ç”¨å·²æœ‰çš„é€šç”¨ HTML æ¨¡æ¿ï¼Œä½†åœ¨å°ç¨‹åºä¸­ä½¿ç”¨ HTML éœ€è¦åšä¸€æ­¥é¢å¤–çš„å¤„ç†å·¥ä½œ</p> <p>ğŸ”§ å…·ä½“å®ç°</p> <p><a href="https://github.com/icindy/wxParse" target="_blank" rel="noopener noreferrer">ä¸‹è½½ wxParse.js æ–‡ä»¶å¹¶å¼•å…¥é¡¹ç›®ä¸­<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>åœ¨éœ€è¦è§£æ HTML çš„é¡µé¢ä¸­å¼•ç”¨</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// pages/schoolDetail/schoolDetail.js</span>
<span class="token keyword">var</span> WxParse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../../../wxParse/wxParse.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * é¡µé¢çš„åˆå§‹æ•°æ®
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    article<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å¤åˆ¶HTMLå¹¶è¿›è¡Œè§£æ</span>
    <span class="token keyword">let</span> article <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id=&quot;u8&quot; class=&quot;text&quot; style=&quot;visibility: visible;&quot;&gt;...&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    WxParse<span class="token punctuation">.</span><span class="token function">wxParse</span><span class="token punctuation">(</span><span class="token string">&quot;article&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;html&quot;</span><span class="token punctuation">,</span> article<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// this.setData({article})</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>åœ¨ app.wxss æˆ–åœ¨å¯¹åº”çš„æ ·å¼é“¾è¡¨ä¸­å¼•å…¥ wxParse.wxss</p></blockquote> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token string">&quot;../../../wxParse/wxParse.wxss&quot;</span><span class="token punctuation">;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>éšç§åè®®<span class="token punctuation">&quot;</span></span> <span class="token attr-name">backBull</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../../wxParse/wxParse.wxml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>protocol-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    éšç§æ”¿ç­–
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>line<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wxParse<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{wxParseData:article.nodes}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_5-å°ç¨‹åºè·³è½¬å…¬ä¼—å·æ–‡ç« "><a href="#_5-å°ç¨‹åºè·³è½¬å…¬ä¼—å·æ–‡ç« " class="header-anchor">#</a> 5.å°ç¨‹åºè·³è½¬å…¬ä¼—å·æ–‡ç« </h3> <p>ğŸ”§ å…·ä½“å®ç°</p> <p>åªéœ€å•ç‹¬æ–°å»ºä¸€ä¸ª page åœ¨å…¶ä¸­æ·»åŠ  webview å®¹å™¨å³å¯</p> <blockquote><p>SRC é“¾æ¥ä¸ºè¦è·³è½¬çš„å…¬ä¼—å·æ–‡ç« é“¾æ¥</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-view</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://mp.weixin.qq.com/s/bK_0v-GQ1b0GlUx1uQUtlg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="ğŸ’¡-é‡åˆ°çš„é—®é¢˜"><a href="#ğŸ’¡-é‡åˆ°çš„é—®é¢˜" class="header-anchor">#</a> ğŸ’¡ é‡åˆ°çš„é—®é¢˜</h2> <ol><li>IOS ç¯å¢ƒä¸‹è°ƒç”¨ wx.navigateBack()æ—¶ä¼šå‡ºç°ç›´æ¥é€€å‡ºå°ç¨‹åºçš„æƒ…å†µ</li></ol> <p>â›” é—®é¢˜åŸå› ï¼šæ’é™¤å°ç¨‹åºå †æ ˆé™åˆ¶é—®é¢˜åŠç”Ÿå‘½å‘¨æœŸç›¸å…³å…¼å®¹æ€§é—®é¢˜ï¼Œæš‚æœªå‘ç°é—®é¢˜åŸå› </p> <p>âœ… è§£å†³æ–¹æ¡ˆï¼šç‰ºç‰²äº¤äº’é€‰æ‹© wx.redirectTo()è¿›è¡Œé¡µé¢è·³è½¬ä»¥å…¼å®¹æ­¤ç§åœºæ™¯</p> <ol start="2"><li>IOS ç¯å¢ƒä¸‹ iPhoneX åŠç›¸ä¼¼æœºå‹åº•éƒ¨æ“ä½œæ ä¼šå‡ºç°ç©ºç™½é—´éš™</li></ol> <p>â›” é—®é¢˜åŸå› ï¼šæœªé’ˆå¯¹éƒ¨åˆ† IOS æœºå‹åšåº•éƒ¨å®‰å…¨è·ç¦»é€‚é…</p> <p>âœ… è§£å†³æ–¹æ¡ˆï¼šä»¥ä¸€ä¸ªç”¨ç»å¯¹å®šä½æ ·å¼çš„åº•éƒ¨æ“ä½œæŒ‰é’®ä¸ºä¾‹</p> <div class="language-css extra-class"><pre class="language-css"><code> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
  ----&gt;è¿™ä¸‰ç§æƒ…å†µéƒ½å¿…é¡»æŒ‰ç…§é¡ºåºå†™<span class="token punctuation">,</span><span class="token property">å¦åˆ™ä¸ç”Ÿæ•ˆbottom</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>
    <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span> + 90rpx
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  ----&gt;padding/<span class="token property">marginç­‰æ ·å¼åŒç†bottom</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>
    <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span> + 90rpx
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  ----&gt;<span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>ä¸åŒæœºå‹æƒ…å†µä¸‹é¡µé¢é¡¶éƒ¨çš„æ“ä½œæ ä¼šå‡ºç°é—´éš™æˆ–é«˜åº¦ä¸å¯¹çš„æƒ…å†µ</li></ol> <p>â›” é—®é¢˜åŸå› ï¼šå„æœºå‹çŠ¶æ€æ é«˜åº¦ä¸åŒæœªé€‚é…</p> <p>âœ… è§£å†³æ–¹æ¡ˆï¼šåŠ¨æ€è·å–è®¾å¤‡çŠ¶æ€æ é«˜åº¦å¹¶ä¸ºæ“ä½œæ åŠ¨æ€è®¾ç½®</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//app.js</span>
wx<span class="token punctuation">.</span><span class="token function">getSystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>statusBarHeight <span class="token operator">=</span> res<span class="token punctuation">.</span>statusBarHeight<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
globalData<span class="token operator">:</span> <span class="token punctuation">{</span>
    statusBarHeight<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>//åŠ¨æ€è®¾ç½®æ“ä½œæ é«˜åº¦
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span>
  <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æˆ‘çš„è®¢å•<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">backBull</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">isFromTransfer</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{isFromTransfer}}<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>option-block<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name">
  <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>fixed<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>0<span class="token selector">;top:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>optionTop<span class="token punctuation">}</span><span class="token punctuation">}</span>rpx<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token operator">:</span> <span class="token punctuation">{</span>
    optionTop<span class="token operator">:</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>statusBarHeight
 <span class="token punctuation">}</span>
 <span class="token operator">...</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f7a45569.js" defer></script><script src="/assets/js/3.2c4a51d3.js" defer></script><script src="/assets/js/18.f868f70d.js" defer></script>
  </body>
</html>
